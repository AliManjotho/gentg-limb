# Generative Pose Corrector (GPC) training config
seed: 42
output_dir: outputs/gpc_base
precision: amp_bf16

dataset:
  name: human36m
  root: data/h36m
  joints: 17
  window: 27                # shorter temporal window for diffusion
  stride: 1
  train_split: train
  val_split: val
  camera_model: perspective

conditioning:
  use_tgt_preds: true       # condition on saved TGT outputs (.npz)
  use_2d_keypoints: true
  sigma_threshold: 0.35     # Ï„ for selective resampling
  keep_confident_locked: true

diffusion:
  type: ddpm                # ddpm | ddim
  steps: 1000
  sampler_steps: 50
  beta_schedule: cosine     # cosine | linear | sqrt
  guidance:
    reproj_weight: 0.5
    limb_len_weight: 0.25
    symmetry_weight: 0.25

dataloader:
  batch_size: 24
  num_workers: 8
  pin_memory: true

model:
  d_model: 256
  n_heads: 8
  n_layers: 8
  ff_mult: 4
  dropout: 0.1
  denoiser: unet_transformer
  temporal_encoding: relative

loss:
  diffusion_weight: 1.0

optimizer:
  name: adamw
  lr: 1e-4
  weight_decay: 0.05
  betas: [0.9, 0.999]

scheduler:
  name: cosine
  warmup_steps: 1000
  min_lr: 1e-6

train:
  epochs: 80
  grad_clip: 1.0
  ema:
    enabled: true
    decay: 0.999

logging:
  interval: 50
  eval_interval: 1000
  checkpoint_interval: 5000
  tensorboard: true
  wandb:
    enabled: false
    project: gentg-limb
