# Optional end-to-end finetuning (TGT + GPC)
seed: 42
output_dir: outputs/e2e_finetune
precision: amp_bf16

dataset:
  name: human36m
  root: data/h36m
  joints: 17
  window_tgt: 155
  window_gpc: 27
  stride: 1
  train_split: train
  val_split: val
  camera_model: perspective

bridge:
  stop_gradient: true       # stop-grad from GPC into TGT features except uncertainty head
  update_sigma_head: true

optimizer:
  name: adamw
  lr: 3e-4
  weight_decay: 0.05
  betas: [0.9, 0.999]

scheduler:
  name: cosine
  warmup_steps: 1500
  min_lr: 1e-6

loss_weights:
  tgt:
    mpjpe: 0.6
    reproj: 0.6
    limb_len_smooth: 0.15
    symmetry: 0.15
  gpc_guidance:
    reproj: 0.3
    limb_len: 0.15
    symmetry: 0.15
  diffusion: 0.7

train:
  epochs: 40
  grad_clip: 1.0

logging:
  interval: 50
  eval_interval: 1000
  checkpoint_interval: 5000
  tensorboard: true
  wandb:
    enabled: false
    project: gentg-limb
